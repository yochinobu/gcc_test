/***************************************************************/
/*                                                             */
/*      PROJECT NAME :  gcc_test                               */
/*      FILE         :  gcc_test.cpp                           */
/*      DESCRIPTION  :  Main Program                           */
/*                                                             */
/*      This file was generated by e2 studio.                  */
/*                                                             */
/***************************************************************/

#include <TUT_BasicSource/header/setup.h>
#include <Led/Led.h>
#include <DipSwitch/DipSwitch.h>
#include <UART/UART0.h>
#include <Cmt/Cmt0.h>

void interrupt_function_4(Led *led, DipSwitch *dip_switch, UART *uart_print){
	static bool led_state = false;
	led_state = !led_state;
	led->output(led_state);
	uart_print->Printf("change, world! :%x\n", dip_switch->read_dip_switch());
}

int main(void) {
	setup();

	Led *led = new Led1();
	DipSwitch *dip_switch = new DipSwitch();

	UART *uart_print;
	uart_print = new UART0(UART::B115200, UART::SCI_BUFFERSIZE);

	Cmt *cmt = new Cmt0(1e-4);
	cmt->attach_interrupt(std::bind(interrupt_function_4, led, dip_switch, uart_print), 0.5);
	cmt->run();

	uart_print->Printf("hello, world!\n");


	while(1) {

	// TODO: add application code here
    }
return 0;
}
